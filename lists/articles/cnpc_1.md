[Return back](../articles.md#Articles)

----
## Guide to NPC in Modpacks for Singleplayer

So, everyone knows about custom NPC. The customizable NPC mod for creating quests, dialogues, or even in game tutorials for servers. But if you've ever wondered whether it was possible to have NPC generate in single player worlds, to add RPG elements to a modpack, the answer is yes. The following is a guide on how to do this. For this to work, you will need the mods Recurrent Complex (to spawn in NPC), CustomNPC (for the NPC), Default World Generator Port (for injecting files into saves on world creation), and inControl (if doing method #2). There are two methods for generating NPC in survival worlds:


#### Method 1

The first is through the use of structures. Recurrent Complex (RC) saves all block and entity data in its structures, and this means NPC too. So you will have to use structures to spawn NPC in. 

**Step 1:** Create a structure and place your NPC inside. Set up any dialogues, quests, behavior, etc that you want. You must disable the AI option "return to start," as this will cause the NPC to bug out and teleport to 0,0,0. Since they won't be returning to start, allowing them to wander might also be a bad idea depending on your structure. It is recommended that your structure enclose or block the NPC in some way to prevent them from wandering off. Note that NPC inside structures can not have any pathing assigned to them. 

**Step 2:** Create a client side clone of your NPC, then export your RC structure. Now go into your save folder and open the save for this world. Locate the folder "customnpc", and copy the folders inside named "quests" and "dialogue." Then go into your config folder and locate the config folder for "defaultworldgenerator." Inside, create a folder named whatever you want, and then inside this custom folder create one named **exactly** "customnpc." This is your profile folder. Inside, paste the folders you copied from customnpc in your saves folder to customnpc in your profile folder. Now go to the root directory of your Minecraft instance (where the folders for crash reports, mods, configs, etc are located). There should be another folder named "customnpc." Go inside and copy the "clones" folder and paste it into the profile folder you made earlier (same path as others).

**Step 3:** Load up Minecraft and click on mods to see all loaded mods. Look for defaultworldgenerator-port and click "config." Here you can restrict certain settings to force them when a player creates a world of you want, or just leave them default. Depends on your pack, but doesn't matter right now. The thing you are looking for is "data files." Inside here, you can select folder profiles which should be named whatever you set it to before (this is the folder you copied everything into. The name must match exactly, then click "add"). Select the folder to set it for this profile. Remember to save all your settings and enable this profile by selecting "yes" for any options that say "listed." If you want players to be able to create regular worlds (for testing/ super flat/ whatever), you'll need to create two of these profiles and list both (one with default settings or whatever you want).

**Note on editing and more:** Due to the way this works, any time you edit an NPC from a structure, you will need to re-do this entire process. This means editing the NPC, cloning it, exporting the structure, and copying the folders over again. For this reason I recommend having a "build" world where you have all your structures out so you can finish any edits, cross NPC interactions, etc or come back and edit them if needed. You can always import the structure for the NPC you want to edit and then export from that world (as long as the exported data is up to date), but remember that you need to copy over from the save folder of the world in which you did the editing! I prefer to use one world so I don't get confused. If you do, keep frequent backups! Automatically is best, as well as starting manual ones after large portions of work.  

Now, a note on unique NPC. For those that know, you can control under what conditions dialogue for an NPC appears, and it can be dependent on quests or dialogues from other NPC. It can be very complex.

In the case of structures that spawn randomly, and thus more than once, if you have an NPC that has such conditions, then it will be shared by all NPC that spawn from this structure. E.g if a merchant named Twisted Dave only talks to you after completing a fetch quest, but before talking to Trader Mike, then if you've already talked to the Trader, every single Twisted Dave you come across will no longer talk to you. Since they are literally clones and all identical, their dialogue conditions are shared. So this, along with the fact that it would be really weird to come across multiple clones of the same unique NPC, may cause you to only want one of them to appear in a given world. For this, you will have to use "static generation" for a structure so it only appears once (and by extension, in the same exact place every world). I prefer to give NPC that appear multiple times generic names and dialogue that would make sense to encounter more than once, and unique names and dialogue to NPC in static structures. This is just a design preference and is up to the dev, but keep in mind the side effects mentioned above. Static structure gen on worlds that don't have a set seed has its own problems and requires structures that are built to blend into any terrain, but that's another subject entirely.

#### Method 2

(need to rewrite by using Specified Spawning mod)

In the case of structures that spawn randomly, and thus more than once, if you have an NPC that has such conditions, then it will be shared by all NPC that spawn from this structure. E.g if a merchant named Twisted Dave only talks to you after completing a fetch quest, but before talking to Trader Mike, then if you've already talked to the Trader, every single Twisted Dave you come across will no longer talk to you. Since they are literally clones and all identical, their dialogue conditions are shared. So this, along with the fact that it would be really weird to come across multiple clones of the same unique NPC, may cause you to only want one of them to appear in a given world. For this, you will have to use "static generation" for a structure so it only appears once (and by extension, in the same exact place every world). I prefer to give NPC that appear multiple times generic names and dialogue that would make sense to encounter more than once, and unique names and dialogue to NPC in static structures. This is just a design preference and is up to the dev, but keep in mind the side effects mentioned above. Static structure gen on worlds that don't have a set seed has its own problems and requires structures that are built to blend into any terrain, but that's another subject entirely.

----
[Scroll back](#Guide-to-NPC-in-Modpacks-for-Singleplayer)


